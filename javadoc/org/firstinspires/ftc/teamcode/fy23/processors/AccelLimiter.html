<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) on Sat Dec 07 23:11:53 CST 2024 -->
<title>AccelLimiter</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2024-12-07">
<meta name="description" content="declaration: package: org.firstinspires.ftc.teamcode.fy23.processors, class: AccelLimiter">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.firstinspires.ftc.teamcode.fy23.processors</a></div>
<h1 title="Class AccelLimiter" class="title">Class AccelLimiter</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.firstinspires.ftc.teamcode.fy23.processors.AccelLimiter</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">AccelLimiter</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">A suite of tools for controlling acceleration.
 <p>AccelLimiter (currently?) only works in one dimension. It can do three things:</p>
 <ul>
     <li>Limit acceleration on one or more devices<ul>
         <li>When limiting on multiple devices, it maintains the proportions between them so that they behave the
         way you'd expect.</li>
     </ul></li>
     <li>Calculate stopping distance</li>
     <li>Ramp up and down to a target position<ul>
         <li>This will likely be split out into one or more separate classes in the near future.</li>
     </ul></li>
 </ul>

 <p>There is one major rule to using AccelLimiter: <b>Be consistent with your units!</b> If you use ticks per second when
 creating an AccelLimiter object, you must continue using ticks per second in all subsequent uses of it.</p>

 <hr>

 <h2>Creating new AccelLimiter objects</h2>
 <p>Each thing you want to limit acceleration on should have its own instance of AccelLimiter. (This is because each instance
 only stores and uses one set of parameters.)</p>
 <p>To create a new AccelLimiter object, you need to determine two things. You can use any unit of acceleration you want, as long as you
 use the same unit everywhere. You can technically use motor power if encoders are not available, but it is not
 recommended. More common units are meters per second per second (if you really need real-world relatability) or, ideally for
 FTC, ticks per second per second (t/s²). With t/s², the motor.getVelocity() and motor.setVelocity() methods will already
 work in the units we need. Anyway, the two things we need to determine are:</p>
 <ul>
     <li>Maximum Acceleration</li>
     <li>Maxinum change in velocity each time a request*() method is called<ul>
         <li>With this, if one iteration of the program loop takes longer than normal, the speed won't suddenly increase
         more than we expect.</li>
     </ul></li>
 </ul>

 <p>Pass these parameters into the constructor:</p>
 <pre><code>@Override
 public void init() {
     double maxAccel = 100; // For our purposes, this is in t/s².
     double maxDeltaVEachLoop = 10;
     AccelLimiter exampleAL = new AccelLimiter(maxAccel, maxDeltaVEachLoop);
 // method to be continued...</code></pre>

 <hr>

 <h2>Limiting Acceleration on a Single Device</h2>
 <p>There are two methods that you can call in every iteration of your loop to do this:</p>
 <ul>
     <li><code>public double requestDeltaVel(double deltaVel, double currentTime)</code><ul>
         <li>Takes a change in velocity and limits it based on the given maximum acceleration and how much time has
         passed since it was called last.</li></ul></li>
     <li><code>public double requestVel(double newVel, double currentVel, double currentTime)</code><ul>
         <li>Does the same thing, but takes and returns the entire velocity rather than only taking the change. (This
         is shorthand. Under the hood, it figures out the change, limits that, then adds it back to the rest.)</li></ul></li>
 </ul>
 <p>Let's limit the acceleration on a single motor using the AccelLimiter we created earlier. We'll use a DcMotor named
 "exampleMotor" and the requestVel() method.</p>
 <p>Remember that our max. acceleration is 100 t/s². 100 t/s will be our max. drive velocity, so it will take us 1 second
 to reach full speed.</p>
 <p>Also, since our maxDeltaVEachLoop is 10 t/s², if a loop takes longer than 100ms, it won't increase its speed more than
 this limit on that loop.</p>
 <pre><code>
     // We need to pass the time into the request*() methods so AccelLimiter knows how much time passes between calls.
     ElapsedTime stopwatch = new ElapsedTime();

     DcMotorEx exampleMotor = hardwareMap.get(DcMotorEx.class, "motor");
 } // end init()

 @Override
 public void loop() {
     // "Requested", as in what the driver wants to do
     // Let's say that our drive velocity runs from -100 to +100 ticks per second.
     double requestedDriveVelocity = (gamepad1.right_trigger - gamepad1.left_trigger) * 100;

     // The user request can jump from 0 to 100.
     // AccelLimiter will only change it as fast as maxAccel allows it to.
     // Here, if a loop takes 50ms, it will only change it by 5 t/s that loop.
     double limitedDriveVelocity = exampleAL.requestVel(requestedDriveVelocity, exampleMotor.getVelocity(), stopwatch.milliseconds());

     // If this is a real motor, you should see it gradually ramp up and down as you press the triggers.
     exampleMotor.setVelocity(limitedDriveVelocity);
 }</code></pre>
 <br>
 <p>To limit acceleration on multiple motors that act independently (like PixelArm - the pivot and elevator motors do not
 affect each other), create a separate AccelLimiter object for each. If the motors are connected together, like they
 are on the drivebase, continue to the next section.</p>

 <hr>

 <h2>Limiting Acceleration on Multiple [Interconnected] Devices</h2>
 <p>This is done with the following method:</p>
 <br>
 <code>public List&lt;Double&gt; requestDeltaVelOnN(List deltaVelList, double currentTime)</code>
 <br><br>
 <p>(There is no requestVelOnN() method. You must use change in velocity.)</p>
 <p>NOTE: This method is meant for multiple motors that are interconnected (the speed of one affects the rest). If your
 motors act independently (like PixelArm - the pivot and elevator motors do not affect each other), see the previous
 section.</p>
 <p>This application is not common enough to include an example here. For an example implementation, look at the code of
 <a href="../robot/subsystems/normalimpl/RRMecanumDriveImpl.html" title="class in org.firstinspires.ftc.teamcode.fy23.robot.subsystems.normalimpl"><code>RRMecanumDriveImpl</code></a>.applyDTS().</p>

 <hr>

 <h2>Calculating Stopping Distance</h2>
 <code>public double stoppingDistance(double currentVel, int resolution)</code>
 <br><br>
 <p>This method uses the maxAccel parameter already set for its AccelLimiter instance to determine how far the device will
 continue travelling while it's ramping down from the given velocity.</p>
 <p>The resolution argument controls how precise the calculation is. A higher resolution yields a more accurate result
 but takes longer to calculate. 1000 seems to be a happy medium, getting close enough without taking too long.</p>
 <br>
 <code>double stoppingDistance = exampleAL.stoppingDistance(motor.getVelocity(), 1000)</code>
 <br><br>
 <p>stoppingDistance now (roughly) equals the distance we will continue to travel while we are ramping down, or the
 distance we need to have available to stop safely.</p>
 <p>One potential application of this is ramping down towards the end of an actuator's range. The stopping distance will
 tell you at what point you must start slowing down.</p>
 <br>
 <p>Let's consider an example that lets us easily test our example: Our maximum acceleration is 100 t/s², and we're
 going 100 t/s. The line of our deceleration will cut the square of 100 t/s over 1 second in half, making it a
 triangle with half the area. In other words, we will tarvel 50 ticks while we're still ramping down, or half the
 distance we would have traveled at full speed. That is our stopping distance. If we built the example above correctly,
 stoppingDistance should roughly equal 50.</p>
 <p>Also, our logic with the graph is the same logic behind a faster way to calculate the stopping distance for linear
 acceleration:</p>
 <br>
 <code>public double simpleStoppingDistance(double currentVel)</code>
 <br><br>
 <p>Currently, AccelLimiter only supports linear acceleration, so you may as well use this method. The other methods
 (which integrate the area under the line of acceleration), however, may enable new functionality in the future (i.e.
 other acceleration curves).</p>

 <hr>

 <h2>Ramping Up/Down to a Target Position</h2>
 <p>If you're doing this on a single motor, you do not want to use AccelLimiter to do this. Use the SDK's
 DcMotor.setTargetPosition() method instead.</p>
 <p>That said, if you have a fun issue like your motor's encoder counting backwards and the SD won't work for you,
 this might be a stopgap solution until you can fix the motor. What this is really made for, however, is more complex
 applications such as moving the entire drivetran (4 motors with different encoder positions and rotation directions)
 until a target position is reached on one of the dead wheels.</p>
 <p>There is no blocking version of this (yet?). It must be done asynchronously.</p>
 <br>
 <code>public void setupRampAlongDistance(double currentPos)</code>
 <br><br>
 <p>You can call this at any time to set the target position and the highest speed at which it will travel (perhaps we
 should call it "cruising speed"). This will reset the AccelLimiter object (!) and put it in the correct internal state
 for later updateRampAlongDistance() calls to work correctly.</p>
 <br>
 <code>public double updateRampALongDistance(double currentPos)</code>
 <br><br>
 <p>Call this on every loop <i>after</i> setting up the ramp using the previous method. It will return the velocity
 that you should send to the motor each loop. See the basic example below:</p>
 <pre><code>
 // We want to go to encoder position 1000 at 100 t/s.
 // We'd put this in our init().
 exampleAL.setupRampAlongDistance(1000, 100);

 // Here, we give it our position and it gives us the velocity.
 // We'd put this in our loop().
 double applyVel = exampleAL.updateRampAlongDistance(motor.getCurrentPosition());

 // Here you could do any additional processing on the velocity before sending it to the motor if necessary.

 motor.setVelocity(applyVel);
 </code></pre></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(double,double)" class="member-name-link">AccelLimiter</a><wbr>(double&nbsp;maxAccel,
 double&nbsp;maxDeltaVEachLoop)</code></div>
<div class="col-last even-row-color">
<div class="block">Create an AccelLimiter object.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getMaxAccel()" class="member-name-link">getMaxAccel</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the maximum acceleration.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getMaxDeltaVEachLoop()" class="member-name-link">getMaxDeltaVEachLoop</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the maximum change in velocity each loop.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getMaxDeltaVThisLoop(double)" class="member-name-link">getMaxDeltaVThisLoop</a><wbr>(double&nbsp;currentTime)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">How much can you change your velocity this loop given the maximum acceleration and how long it's been since last
 time we calculated this? (Will always return 0 while it initializes the first time it's called since this
 AccelLimiter was created or reset)</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#requestDeltaVel(double,double)" class="member-name-link">requestDeltaVel</a><wbr>(double&nbsp;reqDeltaV,
 double&nbsp;currentTime)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Request the desired change in velocity, and this will return how much velocity you can safely add to your
 current velocity given the parameters you entered into the constructor.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#requestDeltaVelOnN(java.util.List,double)" class="member-name-link">requestDeltaVelOnN</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;&nbsp;deltaVelList,
 double&nbsp;currentTime)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Request velocity changes on many actuators, and limit them while maintaining the proportions between them.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#requestVel(double,double,double)" class="member-name-link">requestVel</a><wbr>(double&nbsp;newVel,
 double&nbsp;currentVel,
 double&nbsp;currentTime)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Request the desired final velocity, and this will return the velocity that you can safely go now given the
 parameters you entered into the constructor.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#reset()" class="member-name-link">reset</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Call this when you're done with your task and want to use this object for something else.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setParameters(double,double)" class="member-name-link">setParameters</a><wbr>(double&nbsp;maxAccel,
 double&nbsp;maxDeltaVEachLoop)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Change the parameters of this AccelLimiter instance.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setupRampToTarget(double,double)" class="member-name-link">setupRampToTarget</a><wbr>(double&nbsp;targetPos,
 double&nbsp;maxVelocity)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets up ramping up to maxVelocity and back down along the specified distance.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setupRampToTarget(double,double,com.qualcomm.robotcore.util.ElapsedTime)" class="member-name-link">setupRampToTarget</a><wbr>(double&nbsp;targetPos,
 double&nbsp;maxVelocity,
 com.qualcomm.robotcore.util.ElapsedTime&nbsp;stopwatch)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Used for dependency injection in UnitTests</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#simpleStoppingDistance(double)" class="member-name-link">simpleStoppingDistance</a><wbr>(double&nbsp;initialVel)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">A much faster stopping distance calculation that can be used for linear acceleration (which is all AccelLimiter
 supports at the moment anyway).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#stoppingDistance(double,int)" class="member-name-link">stoppingDistance</a><wbr>(double&nbsp;initialVel,
 int&nbsp;resolution)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">How much distance is needed to stop from the given initial velocity at the maximum acceleration set for your
 AccelLimiter instance? Note that negative velocities still return positive stopping distances.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#updateRampToTarget(double)" class="member-name-link">updateRampToTarget</a><wbr>(double&nbsp;currentPos)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Run this every loop.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(double,double)">
<h3>AccelLimiter</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">AccelLimiter</span><wbr><span class="parameters">(double&nbsp;maxAccel,
 double&nbsp;maxDeltaVEachLoop)</span></div>
<div class="block">Create an AccelLimiter object. (You must do this - the methods are not static.) It will maintain its state until
 it is reset (using the reset() method).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>maxAccel</code> - The maximum acceleration (in any unit you want, but we usually use meters per second)</dd>
<dd><code>maxDeltaVEachLoop</code> - The maximum change in velocity each loop (prevents a sudden velocity change / jerk if a
 loop takes too long)</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="setParameters(double,double)">
<h3>setParameters</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setParameters</span><wbr><span class="parameters">(double&nbsp;maxAccel,
 double&nbsp;maxDeltaVEachLoop)</span></div>
<div class="block">Change the parameters of this AccelLimiter instance.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>maxAccel</code> - The maximum acceleration (in any unit you want, but we usually use meters per second)</dd>
<dd><code>maxDeltaVEachLoop</code> - The maximum change in velocity each loop (prevents a sudden velocity change / jerk if a
 loop takes too long)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMaxAccel()">
<h3>getMaxAccel</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">getMaxAccel</span>()</div>
<div class="block">Get the maximum acceleration. (You set this in the constructor.)</div>
</section>
</li>
<li>
<section class="detail" id="getMaxDeltaVEachLoop()">
<h3>getMaxDeltaVEachLoop</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">getMaxDeltaVEachLoop</span>()</div>
<div class="block">Get the maximum change in velocity each loop. (You set this in the constructor.)</div>
</section>
</li>
<li>
<section class="detail" id="requestVel(double,double,double)">
<h3>requestVel</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">requestVel</span><wbr><span class="parameters">(double&nbsp;newVel,
 double&nbsp;currentVel,
 double&nbsp;currentTime)</span></div>
<div class="block">Request the desired final velocity, and this will return the velocity that you can safely go now given the
 parameters you entered into the constructor.
 (Will always return 0 while it initializes the first time it's called since this AccelLimiter was created or
 reset)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>newVel</code> - The velocity you want to go</dd>
<dd><code>currentVel</code> - The velocity you are currently going</dd>
<dd><code>currentTime</code> - The current time, in the same unit as the time component of your velocity (ex. if velocity is
 in meters per second, then currentTime should be in seconds)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="requestDeltaVel(double,double)">
<h3>requestDeltaVel</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">requestDeltaVel</span><wbr><span class="parameters">(double&nbsp;reqDeltaV,
 double&nbsp;currentTime)</span></div>
<div class="block">Request the desired change in velocity, and this will return how much velocity you can safely add to your
 current velocity given the parameters you entered into the constructor.
 (Will always return 0 while it initializes the first time it's called since this AccelLimiter was created or
 reset)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>reqDeltaV</code> - How much you want to change your velocity</dd>
<dd><code>currentTime</code> - The current time, in the same unit as the time component of your velocity (ex. if velocity is
 in meters per second, then currentTime should be in seconds)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMaxDeltaVThisLoop(double)">
<h3>getMaxDeltaVThisLoop</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">getMaxDeltaVThisLoop</span><wbr><span class="parameters">(double&nbsp;currentTime)</span></div>
<div class="block">How much can you change your velocity this loop given the maximum acceleration and how long it's been since last
 time we calculated this? (Will always return 0 while it initializes the first time it's called since this
 AccelLimiter was created or reset)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>currentTime</code> - The current time, in the same unit as everything else (ex. if the maximum acceleration is in
 meters per second, then currentTime should be in seconds)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="requestDeltaVelOnN(java.util.List,double)">
<h3>requestDeltaVelOnN</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;</span>&nbsp;<span class="element-name">requestDeltaVelOnN</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;&nbsp;deltaVelList,
 double&nbsp;currentTime)</span></div>
<div class="block">Request velocity changes on many actuators, and limit them while maintaining the proportions between them. (Works
 similarly to <a href="../units/DTS.html" title="class in org.firstinspires.ftc.teamcode.fy23.units"><code>DTS</code></a>.normalize().)
 (Will always return 0 while it initializes the first time it's called since this AccelLimiter was created or
 reset)
 This was created for <a href="../robot/subsystems/RRMecanumDrive.html" title="interface in org.firstinspires.ftc.teamcode.fy23.robot.subsystems"><code>RRMecanumDrive</code></a>, but can be used
 in any similar situation involving multiple interconnected actuators.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>deltaVelList</code> - A List&lt;Double&gt; of all the changes in velocity you are requesting</dd>
<dd><code>currentTime</code> - The current time, in the same unit as everything else (ex. if the maximum acceleration is in
 meters per second, then currentTime should be in seconds)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="reset()">
<h3>reset</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">reset</span>()</div>
<div class="block">Call this when you're done with your task and want to use this object for something else.</div>
</section>
</li>
<li>
<section class="detail" id="stoppingDistance(double,int)">
<h3>stoppingDistance</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">stoppingDistance</span><wbr><span class="parameters">(double&nbsp;initialVel,
 int&nbsp;resolution)</span></div>
<div class="block">How much distance is needed to stop from the given initial velocity at the maximum acceleration set for your
 AccelLimiter instance? Note that negative velocities still return positive stopping distances.
 This method sums the area under the curve of the acceleration (the integral). This is not necessary for the
 linear acceleration that AccelLimiter does exclusively at the moment (see the simpleStoppingDistance method), but
 it may become useful with new functionality in the future.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>initialVel</code> - How fast you are going at the moment you start ramping down</dd>
<dd><code>resolution</code> - Higher resolution values make the calculation take longer but yield more accurate results. Use
 the "stoppingDistancePrinter" Unit Test to determine what resolution you need.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="simpleStoppingDistance(double)">
<h3>simpleStoppingDistance</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">simpleStoppingDistance</span><wbr><span class="parameters">(double&nbsp;initialVel)</span></div>
<div class="block">A much faster stopping distance calculation that can be used for linear acceleration (which is all AccelLimiter
 supports at the moment anyway).</div>
</section>
</li>
<li>
<section class="detail" id="setupRampToTarget(double,double)">
<h3>setupRampToTarget</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setupRampToTarget</span><wbr><span class="parameters">(double&nbsp;targetPos,
 double&nbsp;maxVelocity)</span></div>
<div class="block">Sets up ramping up to maxVelocity and back down along the specified distance. Will also reset this instance!</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>targetPos</code> - The position you want to end at (in whatever units you want, as long as you are consistent)</dd>
<dd><code>maxVelocity</code> - The top speed along that distance</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setupRampToTarget(double,double,com.qualcomm.robotcore.util.ElapsedTime)">
<h3>setupRampToTarget</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setupRampToTarget</span><wbr><span class="parameters">(double&nbsp;targetPos,
 double&nbsp;maxVelocity,
 com.qualcomm.robotcore.util.ElapsedTime&nbsp;stopwatch)</span></div>
<div class="block">Used for dependency injection in UnitTests</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>targetPos</code> - The position you want to end at (in whatever units you want, as long as you are consistent)</dd>
<dd><code>maxVelocity</code> - The top speed along that distance</dd>
<dd><code>stopwatch</code> - Pass in a MockElapsedTime to control time in UnitTests.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="updateRampToTarget(double)">
<h3>updateRampToTarget</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">updateRampToTarget</span><wbr><span class="parameters">(double&nbsp;currentPos)</span></div>
<div class="block">Run this every loop. Takes the current position and returns the current velocity along the ramp.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>currentPos</code> - Where are you currently? Should be in the same distance unit as the maximum acceleration.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
